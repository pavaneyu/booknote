---
title: Redis笔记
date: 2022年2月18日14:21:30
tags: []
categories: 学习笔记 
---

# 面试问题

1. Redis 为什么快？

   + 

2. Redis 有哪些常用的数据结构？

   字符串类型：String

   哈希类型：Hash

   列表类型：List

   集合类型：Set

   有序集合类型zset

   Redis中高级用户，HyperLogLog、Geo、Pub/Sub

   

3. Redis RDB 和 AOF 持久化的区别，如何选择？

4. 如何解决缓存击穿、缓存穿透、雪崩问题？

5. 如何用 Redis 实现点赞功能，怎么设计 Key / Value？

# 特点

- 基于内存，数据读写速度快，单机Redis能处理10W+的请求
- 单线程模型，避免了多线程频繁进行上下文切换的时间消耗
- 支持多种数据结构
- 基于非阻塞的多路复用IO机制

# 数据类型

- 

1. String ,二进制安全,即可以包含任何序列化的对象,比如图片

最大512M

简单动态字符串  类似ArrayList ,采用预分配冗余空间方式减少内存频繁分配

redis任何操作都是原子操作,即不会被其他线程打断

​	2.List :单键多值   底层是双向链表

3. set:去重,无序    底层是hash表,所以CRUD的复杂度是O(1)

4. Hash:

​    5.有序集合zset

![](https://s2.loli.net/2022/02/18/wDro6MlgPOAa4KX.png)

# 事务

redis中事务不保证原子性,所以要手动回滚



![image-20220218145201511](https://s2.loli.net/2022/02/18/qFoQg5v6bntLpXr.png)



# 配置文件

单位GB大小写无所谓

导入其他文件

网络  bind ip注释掉  端口

通用 daemonize yes 以守护进程运行,默认no

持久化    save 60  100   在60s内进行100次key的修改,就持久化操作

密码

内存策略



# 持久化

##  RDB快照,默认  (数据有遗失,但恢复快)

1.满足自定义规则,执行flushall或者退出redis          会自动触发rdb

2.优点:适合大规模数据恢复,对数据完整性不高

3.缺点:操作需要时间间隔,最后一次修改的数据可能因为宕机而丢失

## ROF日志 (数据全,但恢复慢,用来追加不全的数据)

1.每一次修改都同步,保证数据完整性

每秒同步一次,可能会丢失这一秒的数据

从不同步.效率最高

2.缺点,数据文件大,修复速度慢.运行效率低 



# 键过期策略



  定时过期

惰性过期

Redis中同时使用了惰性过期和定期过期两种过期策略。

# 内存淘汰策略 -默认LRU,最近最少使用



#  主从复制

主以写为主,从以读为主,读写分离

 作用:数据冗余.故障恢复 ,负载均衡,是高可用的基石

一般单台redis服务器最大内存不超过20g

  环境配置:只配置从库

默认情况下,每台redis服务器都是主节点

全量复制 ,增量复制



# 哨兵模式

监控主机是否故障,如果故障根据投票数,自动替换为主机

如果原来主机恢复,只能当做从机

优点:基于主从复制的优点      主从可以切换,故障可以转移,提高系统可用性    

缺点:不好在线扩容,配置麻烦



# 缓存穿透(查询空的对象)

同时大量查询一个没有记录的对象,缓存没有只能去数据库查,数据库也没有结果,也不会在缓存中记录  ,所以每次这种请求就会直接到数据库

1.布隆过滤器 是一种数据结构,对所有可能查询的参数以hash形式存储,在控制层进行校验,不符合就丢弃,从而避免对数据库的查询压力

2.缓存空对象

# 缓存击穿(一个key,在过期的时候导致)

一个key不停地在抗大并发,当key在过期的瞬间,大并发就会直接访问到数据库

1.设置热点数据永不过期

2.加互斥锁,保证每个key只能有一个线程去数据库查询

# 缓存雪崩 缓存集中失效或者redis宕机

异地多活,保证redis高可用

限流降级,加锁保证一个key只允许一个线程查询

数据预热



